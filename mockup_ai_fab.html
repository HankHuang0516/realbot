<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FAB + BottomSheet AI å®¢æœ Mockup</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #1a1a2e;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    font-family: -apple-system, 'Segoe UI', Roboto, sans-serif;
    overflow: hidden;
  }

  /* â”€â”€ Phone Frame â”€â”€ */
  .phone {
    width: 390px;
    height: 844px;
    background: #0D0D1A;
    border-radius: 40px;
    border: 3px solid #333;
    position: relative;
    overflow: hidden;
    box-shadow: 0 20px 80px rgba(0,0,0,0.6);
  }

  /* â”€â”€ Status Bar â”€â”€ */
  .status-bar {
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 28px;
    color: #fff;
    font-size: 14px;
    font-weight: 600;
  }
  .status-bar .right { display: flex; gap: 6px; align-items: center; font-size: 12px; }

  /* â”€â”€ Top Bar â”€â”€ */
  .top-bar {
    height: 56px;
    display: flex;
    align-items: center;
    padding: 0 20px;
  }
  .top-bar h1 { color: #fff; font-size: 22px; font-weight: 700; }
  .top-bar .edit-btn {
    margin-left: auto;
    width: 36px; height: 36px;
    border-radius: 50%;
    background: transparent;
    border: none;
    color: #fff;
    font-size: 18px;
    cursor: pointer;
  }

  /* â”€â”€ Content Area â”€â”€ */
  .content {
    flex: 1;
    padding: 12px 16px;
    overflow-y: auto;
    height: calc(100% - 50px - 56px - 60px);
  }

  /* â”€â”€ Entity Cards â”€â”€ */
  .entity-card {
    background: #1A1A2E;
    border-radius: 16px;
    border: 1px solid #333355;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .entity-avatar {
    width: 52px; height: 52px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    flex-shrink: 0;
  }
  .entity-avatar.lobster { background: linear-gradient(135deg, #FF6B35, #FF9800); }
  .entity-avatar.pig { background: linear-gradient(135deg, #E91E63, #FF5252); }
  .entity-info { flex: 1; min-width: 0; }
  .entity-name { color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 3px; }
  .entity-status { color: #AAAAAA; font-size: 13px; }
  .entity-status .dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 5px; vertical-align: middle; }
  .entity-status .dot.online { background: #4CAF50; }
  .entity-status .dot.offline { background: #666; }
  .entity-mood { color: #CCCCCC; font-size: 20px; }

  /* add entity card */
  .add-card {
    background: #1A1A2E;
    border-radius: 16px;
    border: 2px dashed #333355;
    padding: 24px;
    text-align: center;
    color: #666;
    font-size: 14px;
    cursor: pointer;
  }
  .add-card .plus { font-size: 28px; color: #7C4DFF; margin-bottom: 6px; }

  /* â”€â”€ Bottom Navigation â”€â”€ */
  .bottom-nav {
    height: 60px;
    background: #0D0D1A;
    border-top: 1px solid #1A1A2E;
    display: flex;
    align-items: center;
    justify-content: space-around;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 10;
  }
  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    cursor: pointer;
    padding: 4px 12px;
    border-radius: 8px;
    transition: all 0.2s;
  }
  .nav-item:hover { background: rgba(124,77,255,0.1); }
  .nav-item.active .nav-icon { color: #7C4DFF; }
  .nav-item.active .nav-label { color: #7C4DFF; }
  .nav-icon { font-size: 22px; color: #CCCCCC; transition: color 0.2s; }
  .nav-label { font-size: 10px; color: #AAAAAA; transition: color 0.2s; }

  /* â”€â”€ FAB â”€â”€ */
  .fab {
    position: absolute;
    bottom: 76px;
    right: 20px;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: linear-gradient(135deg, #7C4DFF, #6200EE);
    border: none;
    color: #fff;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(124, 77, 255, 0.5);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .fab:hover {
    transform: scale(1.08);
    box-shadow: 0 6px 28px rgba(124, 77, 255, 0.7);
  }
  .fab:active { transform: scale(0.95); }
  .fab.hidden {
    transform: scale(0) rotate(180deg);
    opacity: 0;
    pointer-events: none;
  }
  .fab .badge {
    position: absolute;
    top: -2px; right: -2px;
    width: 16px; height: 16px;
    border-radius: 50%;
    background: #F44336;
    border: 2px solid #0D0D1A;
    display: none;
  }
  .fab .badge.show { display: block; }
  .fab-icon {
    width: 28px; height: 28px;
  }

  /* â”€â”€ Scrim (backdrop) â”€â”€ */
  .scrim {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 200;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  .scrim.show {
    opacity: 1;
    pointer-events: auto;
  }

  /* â”€â”€ BottomSheet â”€â”€ */
  .bottom-sheet {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 300;
    background: #0D0D1A;
    border-radius: 24px 24px 0 0;
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), height 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    height: 70%;
  }
  .bottom-sheet.open { transform: translateY(0); }
  .bottom-sheet.fullscreen {
    height: 100%;
    border-radius: 0;
  }

  /* drag handle */
  .sheet-handle {
    width: 100%;
    padding: 12px 0 4px;
    display: flex;
    justify-content: center;
    cursor: grab;
    flex-shrink: 0;
  }
  .sheet-handle .bar {
    width: 36px;
    height: 4px;
    border-radius: 2px;
    background: #444;
  }

  /* sheet header */
  .sheet-header {
    display: flex;
    align-items: center;
    padding: 4px 16px 12px;
    border-bottom: 1px solid #1A1A2E;
    flex-shrink: 0;
  }
  .sheet-header .ai-avatar {
    width: 36px; height: 36px;
    border-radius: 50%;
    background: linear-gradient(135deg, #7C4DFF, #6200EE);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    margin-right: 10px;
  }
  .sheet-header .title-area { flex: 1; }
  .sheet-header .title { color: #fff; font-size: 16px; font-weight: 600; }
  .sheet-header .subtitle { color: #AAAAAA; font-size: 12px; }
  .sheet-header .actions { display: flex; gap: 4px; }
  .sheet-btn {
    width: 36px; height: 36px;
    border-radius: 50%;
    background: transparent;
    border: none;
    color: #999;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
  }
  .sheet-btn:hover { background: #1A1A2E; }

  /* messages */
  .sheet-messages {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .sheet-messages::-webkit-scrollbar { width: 4px; }
  .sheet-messages::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

  .msg { max-width: 82%; display: flex; flex-direction: column; }
  .msg.assistant { align-self: flex-start; }
  .msg.user { align-self: flex-end; }

  .msg-row { display: flex; align-items: flex-end; gap: 8px; }
  .msg.user .msg-row { flex-direction: row-reverse; }

  .msg-avatar {
    width: 28px; height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }
  .msg.assistant .msg-avatar { background: #1A1A2E; border: 1px solid #333; }

  .msg-bubble {
    padding: 10px 14px;
    font-size: 14px;
    line-height: 1.5;
    word-break: break-word;
  }
  .msg.assistant .msg-bubble {
    background: #1A1A2E;
    border: 1px solid #333333;
    border-radius: 4px 16px 16px 16px;
    color: #E0E0E0;
  }
  .msg.user .msg-bubble {
    background: #2A2A4A;
    border-radius: 16px 16px 4px 16px;
    color: #fff;
  }
  .msg-time {
    font-size: 11px;
    color: #666;
    margin-top: 4px;
    padding: 0 36px;
  }
  .msg.user .msg-time { text-align: right; }

  /* welcome state */
  .welcome {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    color: #AAAAAA;
    text-align: center;
    padding: 40px 20px;
  }
  .welcome .emoji { font-size: 48px; }
  .welcome .text { font-size: 14px; line-height: 1.6; }
  .welcome .quick-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    margin-top: 8px;
  }
  .quick-btn {
    background: #1A1A2E;
    border: 1px solid #333355;
    border-radius: 20px;
    padding: 8px 16px;
    color: #CCCCCC;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .quick-btn:hover { border-color: #7C4DFF; color: #7C4DFF; }

  /* input area */
  .sheet-input {
    padding: 8px 12px 12px;
    background: #111122;
    border-top: 1px solid #1A1A2E;
    display: flex;
    align-items: flex-end;
    gap: 8px;
    flex-shrink: 0;
  }
  .attach-btn {
    width: 40px; height: 40px;
    border-radius: 50%;
    background: transparent;
    border: none;
    color: #999;
    font-size: 20px;
    cursor: pointer;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .attach-btn:hover { color: #ccc; }
  .input-wrap {
    flex: 1;
    background: #1A1A2E;
    border: 1px solid #333333;
    border-radius: 20px;
    padding: 0;
    display: flex;
    align-items: flex-end;
  }
  .input-wrap textarea {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: #fff;
    font-size: 14px;
    padding: 10px 16px;
    resize: none;
    max-height: 100px;
    line-height: 1.4;
    font-family: inherit;
  }
  .input-wrap textarea::placeholder { color: #666; }
  .send-btn {
    width: 40px; height: 40px;
    border-radius: 50%;
    background: #FF9800;
    border: none;
    color: #fff;
    font-size: 18px;
    cursor: pointer;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
  }
  .send-btn:hover { background: #FFA726; transform: scale(1.05); }
  .send-btn:active { transform: scale(0.95); }

  /* â”€â”€ Context Tag â”€â”€ */
  .context-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: rgba(124, 77, 255, 0.15);
    border: 1px solid rgba(124, 77, 255, 0.3);
    border-radius: 12px;
    padding: 3px 10px;
    font-size: 11px;
    color: #B39DFF;
    margin-bottom: 8px;
  }

  /* â”€â”€ Typing indicator â”€â”€ */
  .typing { display: flex; gap: 4px; padding: 10px 14px; }
  .typing .dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: #666;
    animation: typingBounce 1.4s infinite;
  }
  .typing .dot:nth-child(2) { animation-delay: 0.2s; }
  .typing .dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes typingBounce {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30% { transform: translateY(-6px); opacity: 1; }
  }

  /* â”€â”€ Page Indicator â”€â”€ */
  .page-indicator {
    position: absolute;
    top: 114px;
    left: 16px;
    right: 16px;
    display: flex;
    gap: 8px;
  }
  .page-tab {
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
    font-weight: 500;
  }
  .page-tab.active {
    background: #7C4DFF;
    color: #fff;
  }
  .page-tab:not(.active) {
    background: #1A1A2E;
    color: #999;
  }
  .page-tab:not(.active):hover {
    color: #ccc;
  }

  /* â”€â”€ Demo Controls â”€â”€ */
  .demo-panel {
    position: fixed;
    top: 20px;
    left: 20px;
    max-width: 280px;
    z-index: 1000;
  }
  .demo-panel h2 { color: #fff; font-size: 18px; margin-bottom: 12px; }
  .demo-panel p { color: #AAAAAA; font-size: 13px; line-height: 1.6; margin-bottom: 16px; }
  .demo-panel .step {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    margin-bottom: 10px;
  }
  .demo-panel .step-num {
    width: 24px; height: 24px;
    border-radius: 50%;
    background: #7C4DFF;
    color: #fff;
    font-size: 13px;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .demo-panel .step-text { color: #CCCCCC; font-size: 13px; line-height: 1.5; padding-top: 2px; }
  .demo-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 16px;
  }
  .demo-btn {
    padding: 8px 16px;
    border-radius: 8px;
    border: 1px solid #333;
    background: #1A1A2E;
    color: #CCCCCC;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .demo-btn:hover { border-color: #7C4DFF; color: #7C4DFF; }
  .demo-btn.active { border-color: #7C4DFF; background: rgba(124,77,255,0.15); color: #7C4DFF; }

  /* Right panel legend */
  .legend {
    position: fixed;
    top: 20px;
    right: 20px;
    max-width: 240px;
    z-index: 1000;
  }
  .legend h3 { color: #fff; font-size: 15px; margin-bottom: 10px; }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }
  .legend-swatch {
    width: 16px; height: 16px;
    border-radius: 4px;
    flex-shrink: 0;
  }
  .legend-label { color: #AAAAAA; font-size: 12px; }

  /* â”€â”€ Animations â”€â”€ */
  @keyframes pulseGlow {
    0%, 100% { box-shadow: 0 4px 20px rgba(124, 77, 255, 0.5); }
    50% { box-shadow: 0 4px 30px rgba(124, 77, 255, 0.8); }
  }
  .fab.pulse { animation: pulseGlow 2s infinite; }

  @media (max-width: 900px) {
    .demo-panel, .legend { display: none; }
  }
</style>
</head>
<body>

<!-- Demo Controls -->
<div class="demo-panel">
  <h2>ğŸ¨ FAB + BottomSheet Mockup</h2>
  <p>äº’å‹•å¼ Mockup â€” æ¨¡æ“¬ Android App çš„ AI å®¢æœæ‡¸æµ®æ°£æ³¡é«”é©—</p>

  <div class="step">
    <div class="step-num">1</div>
    <div class="step-text">é»æ“Šå³ä¸‹è§’<span style="color:#7C4DFF;font-weight:600"> ç´«è‰² FAB</span> é–‹å•Ÿ AI å®¢æœ</div>
  </div>
  <div class="step">
    <div class="step-num">2</div>
    <div class="step-text">æ‹–æ›³é ‚éƒ¨æŠŠæ‰‹å¯åˆ‡æ›<span style="color:#7C4DFF;font-weight:600"> åŠå± â†” å…¨å±</span></div>
  </div>
  <div class="step">
    <div class="step-num">3</div>
    <div class="step-text">é»æ“Šå¿«é€Ÿå•é¡ŒæŒ‰éˆ•æˆ–è¼¸å…¥è¨Šæ¯é«”é©—èŠå¤©</div>
  </div>

  <div class="demo-controls">
    <button class="demo-btn" onclick="switchPage('home')">ğŸ  é¦–é </button>
    <button class="demo-btn" onclick="switchPage('schedule')">ğŸ“‹ æ’ç¨‹</button>
    <button class="demo-btn" onclick="switchPage('chat')">ğŸ’¬ å°è©±</button>
    <button class="demo-btn" onclick="switchPage('files')">ğŸ“ æª”æ¡ˆ</button>
    <button class="demo-btn" onclick="switchPage('settings')">âš™ï¸ è¨­å®š</button>
    <button class="demo-btn" onclick="toggleBadge()" style="border-color:#F44336;color:#F44336">â— æ¨¡æ“¬é€šçŸ¥</button>
  </div>
</div>

<!-- Color Legend -->
<div class="legend">
  <h3>è¨­è¨ˆè‰²ç¥¨</h3>
  <div class="legend-item"><div class="legend-swatch" style="background:#0D0D1A;border:1px solid #333"></div><span class="legend-label">#0D0D1A èƒŒæ™¯</span></div>
  <div class="legend-item"><div class="legend-swatch" style="background:#1A1A2E"></div><span class="legend-label">#1A1A2E å¡ç‰‡/æ°£æ³¡</span></div>
  <div class="legend-item"><div class="legend-swatch" style="background:#7C4DFF"></div><span class="legend-label">#7C4DFF ä¸»è‰² (ç´«)</span></div>
  <div class="legend-item"><div class="legend-swatch" style="background:#FF9800"></div><span class="legend-label">#FF9800 ç™¼é€æŒ‰éˆ• (æ©˜)</span></div>
  <div class="legend-item"><div class="legend-swatch" style="background:#2A2A4A"></div><span class="legend-label">#2A2A4A ç”¨æˆ¶æ°£æ³¡</span></div>
  <div class="legend-item"><div class="legend-swatch" style="background:#111122"></div><span class="legend-label">#111122 è¼¸å…¥å€</span></div>
</div>

<!-- Phone -->
<div class="phone" id="phone">

  <!-- Status Bar -->
  <div class="status-bar">
    <span>9:41</span>
    <div class="right">
      <span>ğŸ“¶</span>
      <span>WiFi</span>
      <span>ğŸ”‹ 85%</span>
    </div>
  </div>

  <!-- Top Bar -->
  <div class="top-bar" id="topBar">
    <h1 id="pageTitle">E-Claw</h1>
    <button class="edit-btn">âœï¸</button>
  </div>

  <!-- Content -->
  <div class="content" id="content">
    <!-- Home page content -->
    <div id="homePage">
      <div class="entity-card">
        <div class="entity-avatar lobster">ğŸ¦</div>
        <div class="entity-info">
          <div class="entity-name">Lobster #0</div>
          <div class="entity-status"><span class="dot online"></span>å·²ç¶å®š â€” é–‹å¿ƒä¸­</div>
        </div>
        <div class="entity-mood">ğŸ˜Š</div>
      </div>
      <div class="entity-card">
        <div class="entity-avatar pig">ğŸ·</div>
        <div class="entity-info">
          <div class="entity-name">Pig #1</div>
          <div class="entity-status"><span class="dot online"></span>å·²ç¶å®š â€” åœ¨èŠå¤©</div>
        </div>
        <div class="entity-mood">ğŸ’¬</div>
      </div>
      <div class="entity-card">
        <div class="entity-avatar lobster">ğŸ¦</div>
        <div class="entity-info">
          <div class="entity-name">Lobster #2</div>
          <div class="entity-status"><span class="dot offline"></span>æœªç¶å®š</div>
        </div>
      </div>
      <div class="add-card">
        <div class="plus">ï¼‹</div>
        æ–°å¢å¯¦é«”
      </div>
    </div>
  </div>

  <!-- FAB -->
  <button class="fab pulse" id="fab" onclick="toggleSheet()">
    <svg class="fab-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z" fill="white" opacity="0.9"/>
      <circle cx="8" cy="10" r="1.5" fill="#7C4DFF"/>
      <circle cx="12" cy="10" r="1.5" fill="#7C4DFF"/>
      <circle cx="16" cy="10" r="1.5" fill="#7C4DFF"/>
    </svg>
    <div class="badge" id="badge"></div>
  </button>

  <!-- Bottom Navigation -->
  <div class="bottom-nav" id="bottomNav">
    <div class="nav-item active" data-page="home" onclick="switchPage('home')">
      <span class="nav-icon">ğŸ </span>
      <span class="nav-label">é¦–é </span>
    </div>
    <div class="nav-item" data-page="schedule" onclick="switchPage('schedule')">
      <span class="nav-icon">ğŸ“‹</span>
      <span class="nav-label">æ’ç¨‹</span>
    </div>
    <div class="nav-item" data-page="chat" onclick="switchPage('chat')">
      <span class="nav-icon">ğŸ’¬</span>
      <span class="nav-label">å°è©±</span>
    </div>
    <div class="nav-item" data-page="files" onclick="switchPage('files')">
      <span class="nav-icon">ğŸ“</span>
      <span class="nav-label">æª”æ¡ˆ</span>
    </div>
    <div class="nav-item" data-page="settings" onclick="switchPage('settings')">
      <span class="nav-icon">âš™ï¸</span>
      <span class="nav-label">è¨­å®š</span>
    </div>
  </div>

  <!-- Scrim -->
  <div class="scrim" id="scrim" onclick="toggleSheet()"></div>

  <!-- Bottom Sheet -->
  <div class="bottom-sheet" id="sheet">
    <div class="sheet-handle" id="sheetHandle">
      <div class="bar"></div>
    </div>

    <div class="sheet-header">
      <div class="ai-avatar">ğŸ¤–</div>
      <div class="title-area">
        <div class="title">E-Claw AI</div>
        <div class="subtitle">éš¨æ™‚ç‚ºä½ è§£ç­”</div>
      </div>
      <div class="actions">
        <button class="sheet-btn" title="å…¨è¢å¹•" onclick="toggleFullscreen()">â¤¢</button>
        <button class="sheet-btn" title="æ¸…é™¤è¨˜éŒ„" onclick="clearChat()">ğŸ—‘ï¸</button>
        <button class="sheet-btn" title="é—œé–‰" onclick="toggleSheet()">âœ•</button>
      </div>
    </div>

    <div class="sheet-messages" id="messages">
      <!-- Welcome state -->
      <div class="welcome" id="welcomeState">
        <div class="emoji">ğŸ¦</div>
        <div class="text">
          Hiï¼æˆ‘æ˜¯ E-Claw AI<br>
          æœ‰ä»»ä½•å¹³å°ä½¿ç”¨å•é¡Œéƒ½å¯ä»¥å•æˆ‘
        </div>
        <div class="context-tag" id="contextTag">
          ğŸ“ ç›®å‰åœ¨ï¼šé¦–é 
        </div>
        <div class="quick-actions">
          <button class="quick-btn" onclick="askQuick('æ€éº¼ç¶å®šæ–°çš„ Botï¼Ÿ')">æ€éº¼ç¶å®š Botï¼Ÿ</button>
          <button class="quick-btn" onclick="askQuick('æ’ç¨‹æ€éº¼è¨­å®šï¼Ÿ')">æ’ç¨‹æ€éº¼è¨­å®šï¼Ÿ</button>
          <button class="quick-btn" onclick="askQuick('æ¡Œå¸ƒä¸æœƒå‹•æ€éº¼è¾¦ï¼Ÿ')">æ¡Œå¸ƒä¸å‹•äº†</button>
        </div>
      </div>
    </div>

    <div class="sheet-input">
      <button class="attach-btn" title="é™„åŠ åœ–ç‰‡">ğŸ“</button>
      <div class="input-wrap">
        <textarea rows="1" placeholder="å•å€‹å•é¡Œâ€¦" id="chatInput" onkeydown="handleKey(event)"></textarea>
      </div>
      <button class="send-btn" onclick="sendMsg()">â¤</button>
    </div>
  </div>
</div>

<script>
  const fab = document.getElementById('fab');
  const sheet = document.getElementById('sheet');
  const scrim = document.getElementById('scrim');
  const badge = document.getElementById('badge');
  const messages = document.getElementById('messages');
  const welcomeState = document.getElementById('welcomeState');
  const chatInput = document.getElementById('chatInput');
  const contextTag = document.getElementById('contextTag');
  let isOpen = false;
  let isFullscreen = false;
  let hasMessages = false;

  const pageTitles = {
    home: 'E-Claw',
    schedule: 'æ’ç¨‹ç®¡ç†',
    chat: 'å°è©±è¨˜éŒ„',
    files: 'æª”æ¡ˆç®¡ç†',
    settings: 'è¨­å®š'
  };

  const pageContexts = {
    home: 'é¦–é ',
    schedule: 'æ’ç¨‹ç®¡ç†',
    chat: 'å°è©±è¨˜éŒ„',
    files: 'æª”æ¡ˆç®¡ç†',
    settings: 'è¨­å®š'
  };

  function toggleSheet() {
    isOpen = !isOpen;
    sheet.classList.toggle('open', isOpen);
    scrim.classList.toggle('show', isOpen);
    fab.classList.toggle('hidden', isOpen);
    badge.classList.remove('show');
    if (isOpen) {
      fab.classList.remove('pulse');
      setTimeout(() => chatInput.focus(), 400);
    }
  }

  function toggleFullscreen() {
    isFullscreen = !isFullscreen;
    sheet.classList.toggle('fullscreen', isFullscreen);
  }

  function switchPage(page) {
    document.getElementById('pageTitle').textContent = pageTitles[page] || 'E-Claw';
    contextTag.innerHTML = 'ğŸ“ ç›®å‰åœ¨ï¼š' + (pageContexts[page] || page);

    // update nav active
    document.querySelectorAll('.nav-item').forEach(item => {
      item.classList.toggle('active', item.dataset.page === page);
    });

    // update demo buttons
    document.querySelectorAll('.demo-btn').forEach(btn => btn.classList.remove('active'));
  }

  function toggleBadge() {
    badge.classList.toggle('show');
    if (badge.classList.contains('show')) {
      fab.classList.add('pulse');
    }
  }

  function clearChat() {
    hasMessages = false;
    messages.innerHTML = '';
    messages.appendChild(welcomeState);
    welcomeState.style.display = 'flex';
  }

  function askQuick(text) {
    chatInput.value = text;
    sendMsg();
  }

  function sendMsg() {
    const text = chatInput.value.trim();
    if (!text) return;

    if (!hasMessages) {
      welcomeState.style.display = 'none';
      hasMessages = true;
    }

    // User message
    const userMsg = document.createElement('div');
    userMsg.className = 'msg user';
    userMsg.innerHTML = `
      <div class="msg-row">
        <div class="msg-bubble">${escHtml(text)}</div>
      </div>
      <div class="msg-time">${timeNow()}</div>
    `;
    messages.appendChild(userMsg);
    chatInput.value = '';
    scrollBottom();

    // Typing indicator
    const typing = document.createElement('div');
    typing.className = 'msg assistant';
    typing.innerHTML = `
      <div class="msg-row">
        <div class="msg-avatar">ğŸ¤–</div>
        <div class="msg-bubble">
          <div class="typing">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
        </div>
      </div>
    `;
    messages.appendChild(typing);
    scrollBottom();

    // Simulated AI reply
    const replies = {
      'æ€éº¼ç¶å®šæ–°çš„ Botï¼Ÿ': 'ç¶å®š Bot å¾ˆç°¡å–®ï¼\n\n1. åœ¨é¦–é é»æ“Šç©ºçš„å¯¦é«”å¡ç‰‡\n2. æœƒé¡¯ç¤ºä¸€çµ„ 6 ä½æ•¸ç¶å®šç¢¼\n3. åˆ° OpenClaw å¹³å°è²¼ä¸Šç¶å®šç¢¼\n4. ç¶å®šæˆåŠŸå¾Œå¯¦é«”æœƒå‡ºç¾åœ¨æ¡Œå¸ƒä¸Š ğŸ‰',
      'æ’ç¨‹æ€éº¼è¨­å®šï¼Ÿ': 'ä½ å¯ä»¥åœ¨ã€Œæ’ç¨‹ç®¡ç†ã€é é¢è¨­å®šï¼š\n\nâ€¢ é»æ“Šå³ä¸‹è§’ ï¼‹ æ–°å¢æ’ç¨‹\nâ€¢ é¸æ“‡è§¸ç™¼æ™‚é–“å’Œé‡è¤‡è¦å‰‡\nâ€¢ è¨­å®šè¦åŸ·è¡Œçš„å‹•ä½œï¼ˆå»£æ’­ã€å¿ƒæƒ…è®ŠåŒ–ç­‰ï¼‰\nâ€¢ æ’ç¨‹æœƒè‡ªå‹•åœ¨æŒ‡å®šæ™‚é–“åŸ·è¡Œ â°',
      'æ¡Œå¸ƒä¸æœƒå‹•æ€éº¼è¾¦ï¼Ÿ': 'æ¡Œå¸ƒä¸å‹•å¯èƒ½æœ‰å¹¾å€‹åŸå› ï¼š\n\n1. ç¢ºèªã€Œå‹•æ…‹æ¡Œå¸ƒã€å·²åœ¨ç³»çµ±è¨­å®šä¸­å•Ÿç”¨\n2. æª¢æŸ¥é›»æ± å„ªåŒ–æ˜¯å¦é™åˆ¶äº† App\n3. å˜—è©¦é‡æ–°è¨­å®šæ¡Œå¸ƒ\n4. å¦‚æœé‚„æ˜¯ä¸è¡Œï¼Œåˆ°ã€Œè¨­å®š â†’ å›å ±å•é¡Œã€æäº¤ Bug ğŸ›',
    };

    const reply = replies[text] || 'æ”¶åˆ°ä½ çš„å•é¡Œï¼æˆ‘æœƒåˆ†æä½ ç›®å‰åœ¨ã€Œ' + (pageContexts[getCurrentPage()] || 'é¦–é ') + 'ã€é‡åˆ°çš„ç‹€æ³ï¼Œè«‹ç¨ç­‰æˆ‘æŸ¥ä¸€ä¸‹â€¦ ğŸ’¡';

    setTimeout(() => {
      messages.removeChild(typing);
      const aiMsg = document.createElement('div');
      aiMsg.className = 'msg assistant';
      aiMsg.innerHTML = `
        <div class="msg-row">
          <div class="msg-avatar">ğŸ¤–</div>
          <div class="msg-bubble">${escHtml(reply).replace(/\n/g, '<br>')}</div>
        </div>
        <div class="msg-time">${timeNow()}</div>
      `;
      messages.appendChild(aiMsg);
      scrollBottom();
    }, 1500);
  }

  function getCurrentPage() {
    const active = document.querySelector('.nav-item.active');
    return active ? active.dataset.page : 'home';
  }

  function handleKey(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMsg();
    }
  }

  function scrollBottom() {
    setTimeout(() => messages.scrollTop = messages.scrollHeight, 50);
  }

  function escHtml(s) {
    const d = document.createElement('div');
    d.textContent = s;
    return d.innerHTML;
  }

  function timeNow() {
    const d = new Date();
    return d.getHours().toString().padStart(2,'0') + ':' + d.getMinutes().toString().padStart(2,'0');
  }

  // Drag to toggle fullscreen
  let startY = 0;
  const handle = document.getElementById('sheetHandle');
  handle.addEventListener('pointerdown', e => {
    startY = e.clientY;
    handle.setPointerCapture(e.pointerId);
  });
  handle.addEventListener('pointermove', e => {
    if (!startY) return;
    const dy = startY - e.clientY;
    if (dy > 60 && !isFullscreen) {
      isFullscreen = true;
      sheet.classList.add('fullscreen');
      startY = 0;
    } else if (dy < -60 && isFullscreen) {
      isFullscreen = false;
      sheet.classList.remove('fullscreen');
      startY = 0;
    } else if (dy < -100 && !isFullscreen) {
      toggleSheet();
      startY = 0;
    }
  });
  handle.addEventListener('pointerup', () => { startY = 0; });
</script>
</body>
</html>
